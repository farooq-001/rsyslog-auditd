#######################################################################
# Auditd configuration (auditd.conf)
# This file controls the configuration of the audit daemon
# Auth: SNB-TECH
# Date: 20/10/2025
#######################################################################

#### BASIC CONFIGURATION ####
# Enable local event logging
local_events = yes
write_logs = yes
log_file = /var/log/audit/audit.log
log_group = root
log_format = ENRICHED
flush = INCREMENTAL_ASYNC
freq = 50
priority_boost = 4

#### LOG ROTATION ####
# MB, safe default for unknown workload, Keeps ~1 GB audit history
max_log_file = 100
num_logs = 10
max_log_file_action = ROTATE

#### DISK SPACE MANAGEMENT ####
# MB remaining triggers alert
space_left = 500               
space_left_action = EMAIL
admin_space_left = 200
admin_space_left_action = SUSPEND
disk_full_action = SUSPEND
disk_error_action = SUSPEND
verify_email = yes
action_mail_acct = root

#### QUEUE AND OVERFLOW ####
# Safe default for unknown host workload
q_depth = 4000
overflow_action = SUSPEND

#### DAEMON RELIABILITY ####
max_restarts = 10
end_of_event_timeout = 2
plugin_dir = /etc/audit/plugins.d

#### NAME RESOLUTION ####
name_format = NONE
##name = $(hostname)

#### NETWORK SETTINGS (Optional for forwarding) ####
transport = TCP
tcp_listen_queue = 5
tcp_max_per_addr = 1
tcp_client_max_idle = 0
use_libwrap = yes
##tcp_listen_port = 60

#### KERBEROS (Optional) ####
krb5_principal = auditd
##krb5_key_file = /etc/audit/audit.key

#### DISTRIBUTED AUDIT ####
distribute_network = no
